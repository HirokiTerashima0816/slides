### 言語処理のための機械学習入門1.3-1.4

2018/03/01 @HirokiTerashima

---

### 項目

1 必要な数学的知識
- 1.3 確率
- 1.4 連続確率変数

---

### 1.3 確率

---

### 事象

- スポーツで「チームTの試合結果」という例がある
- チームTが勝つ、などの出来事を「事象」
- 事象の集合を「事象空間」
- チームTが勝つ確率が80%だった場合、以下のように表す
$$P("チームTが勝つ") = 0.8$$

---

### 確率変数

- それぞれの実現値に対して0〜1の確率値が対応しているような値
- 「チームTの2試合の勝利数」を表す確率変数を$X$とすると$X$は0, 1, 2
- 確率変数は一般的に大文字、その対応する値は小文字で表す
$$P(X = 0) = 0.1, P(X = 1) = 0.3, P(X = 2) = 0.6$$
- 実用上$X = $を省略して$P(x)$と書くことが多い

---

### 確率変数

- 確率変数のすべての値は足すと1になる
$$\sum_{x \in Xの値の集合}P(x) = 1$$
- どの値がどのくらいの確率を持っているのかを記述したものを**確率分布**
- 確率分布を表した関数を**確率質量関数**もしくは**確率関数**

---

### 期待値, 平均, 分散

- 確率変数Xの**期待値**もしくは**平均**$m_X$は以下で定義する
$$m_X = \sum_x xP(X = x)$$
- 確率変数Xを引数とする関数$f9X)$でも以下のように期待値が計算できる
$$m_{f(X)} = \sum_x f(x)P(X = x)$$

---

### 期待値, 平均, 分散

- $f(x) = (x - m_X)^2$ として期待値を求めると**分散** $\sigma^2_X$が得られる
$$\sigma^2_X = \sum_x (x - m_X)^2 P(X = x)$$
- 分散は確率変数の平均からの離れ具合を表す

---

### 期待値, 平均, 分散

- 値がベクトルのとき、平均もベクトルになる
- これを**平均ベクトル**という

---

### 期待値, 平均, 分散

- **標本平均**とは日常ででてくる「平均」のこと
- 標本平均 $X$ とは観測されたデータ $D = {x^1, \cdots , x^(|D|)}$ に対して
$$\bar{X} = \frac{1}{|D|} \sum_{x^{(i)} \in D} x^{(i)}$$

---

### 期待値, 平均, 分散

- **標本分散** $S^2$ は以下のように定義される
$$S^2 = \frac{1}{|D|} \sum_{x^{(i)} \in D} (x^{(i)} - \bar{X})^2$$

---

### 統合確率と条件付き確率

- Xがxとなり、かつYがyとなる確率 $P(X = x, Y = y)$ をxとyの**結合確率**、**同時確率**という
- $Y = y$ がわかっているときの $X = x$ の確率を、$Y = y$ が与えられたときのxの**条件付き確率**という
- $P(X = x|Y = y)$ もしくは $P(X|Y)$ で表す
- $P(X|Y = y)$ と $P(X|Y)$ はそれぞれ $Y = y$ が与えられたとき、Yを与えられたときの**条件付き確率分布**という

---

### 統合確率と条件付き確率

- 以下が成り立つ
$$P(x,y) = P(x|y)P(y)$$
- 引数が増えても同じ
- **ベイズの定理**
$$P(y|x) = \frac{P(y)P(x|y)}{P(x)}$$
- 条件が増えても同様に成り立つ
$$P(x_2|x_1, x_3) = \frac{P(x_2|x_3)P(x_1|x_2, x_3)}{P(x_1|x_3)}$$

---

### 統合確率と条件付き確率

- $\sum_y P(x, y) = P(x)$ にして$P(x)$を求めたとき、$P(x)$を$x$の**周辺確率**という

---

### 独立性

- 確率変数 $X$, $Y$ 、任意の $x$, $y$ において以下が成立するとき $X$ と $Y$ は**独立**であるという
$$P(X = x, Y = y) = P(X = x)P(Y = y)$$
- 独立ではないときは**従属**という
- 確率変数 $X_3$ のある実現値 $x_3$ に対し、確率変数 $X_1$ , $X_2$ の任意の実現値 $x_1$, $x_2$ について以下が成り立つとき**条件付き独立**という
$$P(X_1 = x_1, X_2 = x_2|x_3) = P(X_1 = x_1|x_3)P(X_2 = x_2|x_3)$$

---

### 代表的な離散確率分布

- **標本空間**とはある確率分布における値がとりうる範囲のこと

---

### 代表的な離散確率分布

- とりうる値が２つであるような確率変数を記述する分布を**ベルヌーイ分布**
- 確率変数 $X$ は確率 $p$ で $a$ 、確率 $1 - p$ で $b$ のとき確率 $P(X = x;p)$ は以下で表せる
$$P(X = x;p) = p^{\delta(x,a)}(1 - p)^{1 - \delta(x,a)}$$
- ベルヌーイ分布に従う確率変数を要素とする確率変数ベクトルを作ったものを**多変数ベルヌーイ分布**という

---

### 代表的な離散確率分布

- 確率 $p$ の事象が $x$ 回、確率 $1 - p$ の事象が $n - x$ 回起こったとして、 $x$ 回起こる確率は
$$P(x;p,n) = {}_n C_x p^x(1 - p)^{n - x}$$
- **二項分布**という
- 事象そのものの確率ではなく、その回数の確率

---

### 代表的な離散確率分布

- $m$ 個の値をとりうる確率変数がある
- 各値には $p_1, p_2, \cdots, p_m$ の確率が与えられている
- $\sum_i p_i = 1$ が成り立つ
- 1回の思考で $m$ 個の値のうち一つが起こる
- これを $n$ 回試行した場合、各値が $k_1, k_2, \cdots, k_m$ 回起こる確率は
$$\frac{n!}{\prod_i k_i !}\prod_i {p_i}^{k_i}$$
- この確率分布を**多項分布**という

---

### 代表的な離散確率分布

- パラメータ $\mu (> 0)$ として、整数 $x(\geqq 0)$ が起こる確率は以下で与えられる
$$P(x;\mu) = \frac{\mu^x}{x!}e^{-\mu}$$
- **ポワソン分布**という
- 二項分布のある種の極限

---

### 連続確率変数

- とびとびでない値をとる変数を**連続変数**という
- 連続変数であり確率変数であるような変数を**連続確率変数**という
- 連速の場合、各値をとる確率は限りなく0に近い
- 各値での次数値は確率というより確率のつまり具合
- この実数値を与える関数を**確率密度関数**という

---

### 平均、分散

$$m = \int xp(x)dx$$
$$\sigma^2 = \int (x - m)^2 p(x)dx$$

---

### 連続確率分布の例

- **正規分布**もしくは**ガウス分布**
- 実世界の多くが正規分布に従うと信じられている

---

### 連続確率分布の例

- **ディリクレ分布**
- $x_i \geqq 0$ , $\sum_i x_i = 1$ であるような $x = (x_1, \cdots, x_n)$ に対して確率を与える分布
